<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Uom-Nettiers on Mike Barram</title>
    <link>http://localhost:1313/tags/uom-nettiers/</link>
    <description>Recent content in Uom-Nettiers on Mike Barram</description>
    <generator>Hugo -- 0.152.2</generator>
    <language>en-gb</language>
    <lastBuildDate>Thu, 23 Feb 2012 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/uom-nettiers/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>naming conventions for custom stored procedures to be used in netTiers</title>
      <link>http://localhost:1313/posts/naming-conventions-for-custom-stored-procedures-to-be-used-in-nettiers/</link>
      <pubDate>Thu, 23 Feb 2012 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/naming-conventions-for-custom-stored-procedures-to-be-used-in-nettiers/</guid>
      <description>&lt;p&gt;Quoting from &lt;a href=&#34;http://www.31a2ba2a-b718-11dc-8314-0800200c9a66.com/2008&#34;&gt;http://www.31a2ba2a-b718-11dc-8314-0800200c9a66.com/2008&lt;/a&gt;_03_01_archive.html&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“If you create your own procs, prefix those procs to something that you won’t confuse with any other library’s procs, such as ‘cust’ for custom. Of cource, IncludeCustoms is set to true and CustomProcedureStartsWith should be set to ‘cust_{0}_’ so that a table name of Profile should have a custom proc of cust_Profile_SelectAll.”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;if you set CustomProcedureStartsWith to just ‘cust_’ as we have done in the past, a method is created for each stored procedure for each table, whereas using ‘cust_{0}_’ only creates one method for each stored procedure – that method is linked to the table its name is based on. Far more sensible.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Beware of entity tracking</title>
      <link>http://localhost:1313/posts/beware-of-entity-tracking/</link>
      <pubDate>Tue, 16 Aug 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/beware-of-entity-tracking/</guid>
      <description>&lt;p&gt;Entity tracking is clever and manages to keep a cache of recently used entities (and lists of entities) and, if it doesn’t see a change to an entity, it will return the cached version without going to the database – that’s what caching is after all. The problem is that ALL changes to the database MUST be made by the same project using .netTiers methods. If you’re developing an application and change data directly in the database then .netTiers won’t spot that. Pretty obvious really but do remember whether you have&lt;br&gt;
&lt;code&gt;enableEntityTracking=&amp;quot;true&amp;quot;&lt;/code&gt;
or&lt;br&gt;
&lt;code&gt;enableEntityTracking=&amp;quot;false&amp;quot;&lt;/code&gt;&lt;br&gt;
in the SqlNetTiersProvider bit of your web.config&lt;/p&gt;</description>
    </item>
    <item>
      <title>useStoredProcedure=true but still runs SELECT statements</title>
      <link>http://localhost:1313/posts/usestoredproceduretrue-but-still-runs-select-statements/</link>
      <pubDate>Fri, 03 Jun 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/usestoredproceduretrue-but-still-runs-select-statements/</guid>
      <description>&lt;p&gt;.netTiers can be configured to only use stored procedures, which is a great way to reduce the possibility of the database being attacked as the user account can be given access to only execute stored procedures and not have any direct access to the tables. To do this, just set useStoredProcedure=true in the netTiers &lt;code&gt;&amp;lt;providers&amp;gt;&lt;/code&gt; section of the web.config&lt;/p&gt;
&lt;p&gt;If you do this, some pages (methods) will still need SELECT access to tables. By default, netTiers creates entitygridviews that use paging and so use the &lt;code&gt;get_paged&lt;/code&gt; method, which calls the &lt;code&gt;myTable_GetPaged&lt;/code&gt; stored procedure. This stored procedure builds a couple of SQL strings (SELECT statements) that are executed, which means that the user account needs to have access to run SELECT statements. To give SELECT access to all tables in the database, you can add the user account to the &lt;code&gt;db_datareader&lt;/code&gt; role.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using the description property of SQL Server fields as the friendly name</title>
      <link>http://localhost:1313/posts/using-the-description-property-of-sql-server-fields-as-the-friendly-name/</link>
      <pubDate>Thu, 17 Mar 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-the-description-property-of-sql-server-fields-as-the-friendly-name/</guid>
      <description>&lt;p&gt;SQL Server allows each field in the database to have a description, so this description seems like the most useful place to put friendly names for fields that will appear on a netTiers generated admin page.&lt;/p&gt;
&lt;p&gt;When netTiers first runs, a config file is generated as specified in 01 MappingFile&lt;br&gt;
This XML file lists all of the tables and for each table it lists all of the fields e.g.&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;Column Id=&amp;#34;title&amp;#34; CSType=&amp;#34;System.String&amp;#34; PropertyName=&amp;#34;Title&amp;#34; FieldName=&amp;#34;_title&amp;#34; FriendlyName=&amp;#34;Title&amp;#34; IncludeInOutput=&amp;#34;true&amp;#34; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;netTiers will automatically convert the database field name of &amp;ldquo;title&amp;rdquo; to a FriendlyName of &amp;ldquo;Title&amp;rdquo;&lt;br&gt;
It’s quite clever too and will convert a field name of &lt;code&gt;&amp;quot;title_or_salutation&amp;quot;&lt;/code&gt; to a FriendlyName of &lt;code&gt;&amp;quot;Title Or Salutation&amp;quot;&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Using stored procedures in entity data sources</title>
      <link>http://localhost:1313/posts/using-stored-procedures-in-entity-data-sources/</link>
      <pubDate>Fri, 18 Feb 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/using-stored-procedures-in-entity-data-sources/</guid>
      <description>&lt;p&gt;The normal &lt;code&gt;&amp;lt;asp:SqlDataSource/&amp;gt;&lt;/code&gt; can use stored procedures as the select method and even for insert/update/delete commands.&lt;/p&gt;
&lt;p&gt;netTiers will create a strongly typed data source for each table. The inserts, updates and deletes are handled automatically but there are options for which records to select. &lt;code&gt;Get_Paged&lt;/code&gt; is the default but you can also get by any foreign key. Sometimes this isn’t enough and you want a custom filter for your entities. To do this, write a stored procedure that returns all of the columns in the base table and no other columns. The SP can have joins to other tables, so you can use those for filtering. The SP can have whatever parameters you like. Because the SP returns all of the columns of the base table, netTiers recognises that it can be used to get a list of entities and so allows it as a SelectMethod e.g.&lt;/p&gt;</description>
    </item>
    <item>
      <title>transactions and creating related records on insert</title>
      <link>http://localhost:1313/posts/transactions-and-creating-related-records-on-insert/</link>
      <pubDate>Wed, 09 Feb 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/transactions-and-creating-related-records-on-insert/</guid>
      <description>&lt;p&gt;After creating a record, you might want to automatically create a related child record, which uses the ID of the record you have just created. In your datasource &lt;code&gt;&amp;lt;data:XyzDataSource&amp;gt;&lt;/code&gt; you can put in &lt;code&gt;OnInserted=&amp;quot;Xyz_Inserted&amp;quot;&lt;/code&gt;:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;data:XyzDataSource ID=&amp;#34;XyzDataSource&amp;#34; runat=&amp;#34;server&amp;#34; SelectMethod=&amp;#34;GetById&amp;#34; OnInserted=&amp;#34;Xyz_Inserted&amp;#34;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-C#&#34; data-lang=&#34;C#&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Xyz&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;_Inserted(Object sender, ObjectDataSourceStatusEventArgs e)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Exception == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (FormView1.CurrentMode == FormViewMode.Insert)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      Xyz myXyz  = (Xyz)e.ReturnValue;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; ID = myXyz .Id;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#75715e&#34;&gt;// now create the child entity, set the parent id and insert it&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The problem with this is that netTiers by default uses transactions and &lt;code&gt;Xyz_Inserted&lt;/code&gt; is called in the middle of the transaction. So, whilst an ID has been returned for the new record, it hasn’t been committed to the database, so you can’t create the child record yet. The way around this is for the datasource to not use transactions.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Database connections timing out in IIS 7.5 – caused by EntityTransactionModule</title>
      <link>http://localhost:1313/posts/database-connections-timing-out-in-iis-7.5-caused-by-entitytransactionmodule/</link>
      <pubDate>Tue, 08 Feb 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/database-connections-timing-out-in-iis-7.5-caused-by-entitytransactionmodule/</guid>
      <description>&lt;p&gt;&lt;strong&gt;Problem:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After using a netTiers powered website for a while, the database connections would start to time out and you’d get a Stack Trace like:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)  
at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)  
at System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Solution:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;NetTiers was using an EntityTransactionModule which was incorrectly configured. It was opening database connections and not closing them (I think) and so SQL Server eventually stops allowing connections. IIS 7.5 needs the following code in the web.config to correctly configure the module.&lt;/p&gt;</description>
    </item>
    <item>
      <title>NetTiers EntityGridView Deepload display readonly lookup</title>
      <link>http://localhost:1313/posts/nettiers-entitygridview-deepload-display-readonly-lookup/</link>
      <pubDate>Tue, 08 Feb 2011 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/nettiers-entitygridview-deepload-display-readonly-lookup/</guid>
      <description>&lt;p&gt;If you need your netTiers gridview (EntityGridView) to have a column that just displays a read only value from a lookup table then the data source will need to deepload but &lt;code&gt;&amp;lt;asp:BoundField&amp;gt;&lt;/code&gt; won’t be able to access the lookup value. NetTiers’ own controls are only dropdowns, hyperlinks and radiobuttons, so to display the lookup value (rather than the ID), you need to add a template field&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;&amp;lt;asp:TemplateField&amp;gt;  
  &amp;lt;ItemTemplate&amp;gt;  
    &amp;lt;%# Eval(&amp;#34;ApplicIdSource.Applic&amp;#34;)%&amp;gt;  
  &amp;lt;/ItemTemplate&amp;gt;  
&amp;lt;/asp:TemplateField&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;as described here:&lt;/p&gt;</description>
    </item>
    <item>
      <title>ID fields</title>
      <link>http://localhost:1313/posts/id-fields/</link>
      <pubDate>Thu, 25 Nov 2010 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/id-fields/</guid>
      <description>&lt;p&gt;Don’t name a field ID, id or Id&lt;/p&gt;
&lt;p&gt;If you ask NetTiers to generate an admin website, then it will show warnings when compiled but these will result in errors when you try to run the site.&lt;/p&gt;
&lt;p&gt;Even if you don’t want an admin website to start with, you may want one later, so just don’t name any fields ID&lt;/p&gt;</description>
    </item>
    <item>
      <title>IF statements in custom stored procedures</title>
      <link>http://localhost:1313/posts/if-statements-in-custom-stored-procedures/</link>
      <pubDate>Wed, 25 Aug 2010 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/if-statements-in-custom-stored-procedures/</guid>
      <description>&lt;p&gt;You may want your custom stored procedures to contain conditional statements such as &lt;code&gt;IF&lt;/code&gt;. These can cause problems when NetTiers inspects the procedure to determine its outputs – it may normally return a table but an &lt;code&gt;IF&lt;/code&gt; statement traps for an exception and conditionally returns before the select statement. You can force NetTiers to follow one route through the code e.g. the statement below will never return for NetTiers&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;IF user_name() &amp;lt;&amp;gt; &amp;#39;NetTiersUserAccount&amp;#39; AND ThingToTest = ValueThatMakesItReturn RETURN
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Just make sure that the user account in the connection string used by NetTiers is not used by anything other than NetTiers i.e. not in you web.config&lt;/p&gt;</description>
    </item>
    <item>
      <title>System.Reflection.AmbiguousMatchException: Ambiguous match found.</title>
      <link>http://localhost:1313/posts/system.reflection.ambiguousmatchexception-ambiguous-match-found./</link>
      <pubDate>Tue, 20 Oct 2009 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/system.reflection.ambiguousmatchexception-ambiguous-match-found./</guid>
      <description>&lt;p&gt;If you get this error with NetTiers, it’s probably because you have a field named with a reserved word such as:&lt;/p&gt;
&lt;p&gt;Tag&lt;br&gt;
ID&lt;br&gt;
SortOrder&lt;/p&gt;
&lt;p&gt;Rename the field&lt;/p&gt;</description>
    </item>
    <item>
      <title>completely close and re-open NetTiers after database changes</title>
      <link>http://localhost:1313/posts/completely-close-and-re-open-nettiers-after-database-changes/</link>
      <pubDate>Thu, 24 Sep 2009 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/completely-close-and-re-open-nettiers-after-database-changes/</guid>
      <description>&lt;p&gt;If you have NetTiers open and have generated code, then make changes to the database, you need to completely close and re-open CodeSmith / NetTiers for it to fully recognise the changes. Something or other gets cached and NetTiers doesn’t spot the database changes – this was a pain to track down.&lt;/p&gt;</description>
    </item>
    <item>
      <title>SortOrder</title>
      <link>http://localhost:1313/posts/sortorder/</link>
      <pubDate>Wed, 23 Sep 2009 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/sortorder/</guid>
      <description>&lt;p&gt;Don’t call a field in the database “SortOrder”&lt;br&gt;
It breaks nettiers in subtle ways that are hard to spot&lt;/p&gt;</description>
    </item>
    <item>
      <title>empty fields</title>
      <link>http://localhost:1313/posts/empty-fields/</link>
      <pubDate>Thu, 03 Apr 2008 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/posts/empty-fields/</guid>
      <description>&lt;p&gt;I’d set up the MedicineExaminers system to not allow nulls on any fields – they were supposed to contain empty strings if there was no data e.g. no email address.&lt;/p&gt;
&lt;p&gt;The NetTiers generated site didn’t like this as it made the fields required. I’ve changed the fields to allow nulls and so now, if I have an empty text box, NetTiers sets the value to null in the database.&lt;/p&gt;
&lt;p&gt;Lookup lists (e.g. speciality) will have values such as “not known”, so foreign keys will never need to be null.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
